# APS智慧排产系统 - UX设计文档

## 1. 概述

基于APS智慧排产思路PRD的业务需求，本文档设计了完整的用户体验方案，涵盖从Excel文件上传到MES导出的全流程用户界面设计。

## 2. 用户角色分析

### 2.1 主要用户角色

| 用户角色 | 职责描述 | 技能水平 | 使用频率 |
|---------|----------|---------|---------|
| 生产调度员 | 负责卷包旬计划录入和排产执行 | 熟悉生产工艺，Excel操作熟练 | 每旬使用 |
| 排产主管 | 监督排产结果，处理异常情况 | 具备排产经验，懂得业务规则 | 定期查看 |
| 系统管理员 | 维护主数据，配置业务参数 | 技术背景，熟悉系统配置 | 按需使用 |

### 2.2 用户画像
**主要用户：生产调度员 - 张师傅**
- 年龄：45岁，从事烟草生产调度15年
- 工作场景：每旬开始时需要录入新的卷包旬计划，处理生产调度
- 技术特点：熟练使用Excel，希望系统界面直观易用
- 痛点：原有排产方式效率低，容易出错，希望系统能自动化处理

## 3. 用户流程设计

### 3.1 主流程图

```mermaid
graph TD
    A[登录系统] --> B[选择"卷包排产"]
    B --> C[上传Excel文件]
    C --> D{文件验证}
    D -->|失败| E[显示错误信息]
    E --> C
    D -->|成功| F[数据预览确认]
    F --> G[数据入库]
    G --> H[点击"开始排产"]
    H --> I[排产参数设置]
    I --> J[执行排产算法]
    J --> K[规则合并/拆分]
    K --> L[校正与并行切分]
    L --> M[生成机台/喂丝工单]
    M --> N[结果展示]
    N --> O[导出至MES]
    O --> P[完成]
    
    N --> Q[修改参数重新排产]
    Q --> I
    
    F --> R[修改数据]
    R --> F
```

### 3.2 详细用户故事

#### 故事1：Excel文件上传
**作为** 生产调度员  
**我想要** 能够快速上传卷包旬计划Excel文件  
**以便** 将计划数据导入系统进行排产

**操作步骤：**
1. 点击"上传文件"按钮
2. 选择或拖拽Excel文件到上传区域
3. 系统自动验证文件格式和数据完整性
4. 显示文件信息和验证结果

**验收标准：**
- 支持.xlsx和.xls格式
- 上传进度实时显示
- 数据验证错误有明确提示
- 上传成功后显示文件摘要信息

#### 故事2：数据预览与确认
**作为** 生产调度员  
**我想要** 预览导入的数据内容  
**以便** 确认数据正确性并进行必要修改

**操作步骤：**
1. 上传成功后自动显示数据预览表格
2. 查看生产单元、牌号、机台信息等
3. 修改异常数据或确认无误
4. 点击"确认导入"按钮

#### 故事3：排产执行与监控
**作为** 生产调度员  
**我想要** 实时监控排产算法执行过程  
**以便** 了解排产进度和处理状态

**操作步骤：**
1. 点击"开始排产"按钮
2. 设置排产参数（可选）
3. 观察排产进度条和阶段提示
4. 等待排产完成

## 4. 界面设计

### 4.1 整体布局设计

系统采用简洁的现代化界面设计，主要包含：

```
+--------------------------------------------------+
|  APS智慧排产系统               [用户] [设置]     |
+--------------------------------------------------+
|  [主数据] [排产管理] [结果查看] [系统配置]        |
+--------------------------------------------------+
|                                                  |
|               主要内容区域                        |
|                                                  |
|            (动态加载不同功能模块)                 |
|                                                  |
+--------------------------------------------------+
|  状态栏：当前操作状态 | 最后更新时间 | 系统版本    |
+--------------------------------------------------+
```

### 4.2 核心界面设计

#### 4.2.1 文件上传界面

```
+----------------------------------------+
|           卷包旬计划导入                |
+----------------------------------------+
|                                        |
|  步骤1：选择文件                        |
|  +----------------------------------+  |
|  |        文件上传区域              |  |
|  |                                  |  |
|  |   📁 拖拽Excel文件到此处         |  |
|  |      或点击选择文件              |  |
|  |                                  |  |
|  |    [选择文件]  [清空]            |  |
|  +----------------------------------+  |
|                                        |
|  文件要求：                            |
|  • 支持格式：.xlsx, .xls              |
|  • 文件大小：≤10MB                     |
|  • 必需列：生产单元、牌号、机台等      |
|                                        |
|  +----------------------------------+  |
|  | 上传状态：                       |  |
|  | 文件名：卷包旬计划_20241201.xlsx |  |
|  | 大小：2.5MB                      |  |
|  | 状态：✓ 验证通过                 |  |
|  +----------------------------------+  |
|                                        |
|        [取消]        [下一步]          |
+----------------------------------------+
```

#### 4.2.2 数据预览界面

```
+----------------------------------------+
|           数据预览与确认                |
+----------------------------------------+
| 步骤2：确认导入数据                     |
|                                        |
| 数据统计：                             |
| 总记录数：15条 | 有效记录：15条         |
| 错误记录：0条  | 警告记录：2条          |
|                                        |
| +----------------------------------+   |
| | 生产单元 | 牌号 | 喂丝机 | 卷包机   |   |
| |    1    |利群  |  14   | C1,C2   |   |
| |    2    |利群  |  16   |  A1     |   |
| |    3    |利群  |  1    | C11     | ⚠ |
| |   ...   | ... | ...   |  ...    |   |
| +----------------------------------+   |
| [显示所有] [仅显示异常] [导出预览]     |
|                                        |
| ⚠ 数据警告：                           |
| • 第3行：成品生产日期跨月，建议检查    |
| • 第8行：投料数量异常偏高              |
|                                        |
|     [返回上传]    [确认导入]           |
+----------------------------------------+
```

#### 4.2.3 排产管理界面

```
+----------------------------------------+
|           排产管理与执行                |
+----------------------------------------+
| 步骤3：执行智能排产                     |
|                                        |
| 当前数据：2024年11月1-15日卷包旬计划   |
| 数据状态：已导入 (15个生产单元)         |
| 导入时间：2024-11-01 09:30              |
|                                        |
| +----------------------------------+   |
| |          排产参数设置            |   |
| |                                  |   |
| | 优化目标：                       |   |
| | [✓] 计划按时完工率优先           |   |
| | [✓] 负荷均衡性优化               |   |
| |                                  |   |
| | 高级选项：                       |   |
| | [ ] 允许跨班次生产               |   |
| | [ ] 忽略轮保计划                 |   |
| | [ ] 强制并行执行                 |   |
| +----------------------------------+   |
|                                        |
| +----------------------------------+   |
| |          排产执行状态            |   |
| |                                  |   |
| | 当前阶段：规则合并/拆分          |   |
| | 进度：[████████░░] 75%          |   |
| |                                  |   |
| | 详细信息：                       |   |
| | • 已处理工单：12/16              |   |
| | • 合并工单：3个                  |   |
| | • 拆分工单：8个                  |   |
| | • 预计完成：还需2分钟            |   |
| +----------------------------------+   |
|                                        |
|     [开始排产]     [重新排产]          |
+----------------------------------------+
```

#### 4.2.4 结果查看界面

```
+----------------------------------------+
|            排产结果展示                 |
+----------------------------------------+
|                                        |
| 排产摘要：                             |
| +--------+--------+--------+--------+   |
| | 总工单 | 卷包台 | 喂丝机 | 按时率 |   |
| |   24   |   16   |   12   | 98.5% |   |
| +--------+--------+--------+--------+   |
|                                        |
| 标签页：[卷包工单] [喂丝工单] [统计图表] |
|                                        |
| +----------------------------------+   |
| | 工单编号 | 机台 | 牌号 | 开始时间 | 结束时间 |
| | JB001   | C1  |利群 |11-01 08:00|11-02 16:00|
| | JB002   | C2  |利群 |11-01 08:00|11-02 16:00|
| | WS001   | 14  |成丝 |11-01 06:00|11-02 18:00|
| | ...     |...  |... |    ...    |    ... |
| +----------------------------------+   |
|                                        |
| 质量指标：                             |
| • 计划按时完工率：98.5% ✓              |
| • 负荷均衡得分：85分                   |
| • 设备利用率：92.3%                    |
|                                        |
| [导出Excel] [导出到MES] [重新排产]    |
+----------------------------------------+
```

### 4.3 交互设计规范

#### 4.3.1 状态反馈设计

| 操作类型 | 视觉反馈 | 文字提示 | 时间要求 |
|---------|---------|---------|---------|
| 文件上传 | 进度条+百分比 | "正在上传..." | 实时更新 |
| 数据验证 | 旋转动画 | "正在验证数据..." | <3秒 |
| 排产执行 | 阶段进度条 | "规则合并中..." | 实时更新 |
| MES导出 | 成功图标 | "导出成功！" | <5秒 |

#### 4.3.2 错误处理设计

**文件格式错误：**
```
❌ 文件格式不支持
请上传.xlsx或.xls格式的Excel文件
当前文件：计划表.txt

解决方案：
1. 确认文件是Excel格式
2. 如是其他格式请转换后重新上传
3. 需要帮助请联系技术支持

[重新选择文件] [查看帮助]
```

**数据验证失败：**
```
⚠️ 数据验证发现问题
共发现3个错误，5个警告

错误详情：
• 第5行：喂丝机号不能为空
• 第8行：开始时间格式错误(应为MM.DD格式)
• 第12行：卷包机号"X99"不在系统中

[查看详细报告] [忽略警告继续] [重新上传]
```

#### 4.3.3 操作确认设计

**重要操作确认：**
```
+--------------------------------+
|        确认开始排产            |
+--------------------------------+
| 即将对以下数据执行排产：        |
| • 时间范围：2024-11-01 ~ 11-15  |
| • 生产单元：15个                |
| • 预计耗时：3-5分钟             |
|                                |
| ⚠️ 注意：此操作将覆盖上次排产结果 |
|                                |
| 是否继续？                      |
|                                |
|      [取消]      [确认执行]     |
+--------------------------------+
```

## 5. 响应式设计

### 5.1 屏幕适配策略

| 设备类型 | 屏幕宽度 | 布局调整 | 功能限制 |
|---------|---------|---------|---------|
| 桌面端 | ≥1200px | 完整布局 | 无限制 |
| 平板端 | 768-1199px | 简化侧栏 | 部分功能 |
| 手机端 | <768px | 单列布局 | 仅查看功能 |

### 5.2 移动端适配

考虑到生产环境的特殊性，系统支持平板端访问：
- **查看功能**：排产结果查看、工单状态监控
- **简单操作**：确认操作、状态更新
- **限制功能**：Excel上传建议在桌面端完成

## 6. 可用性设计

### 6.1 易用性原则

1. **一致性原则**
   - 统一的色彩系统和字体规范
   - 一致的交互模式和操作逻辑
   - 标准化的图标和按钮样式

2. **简洁性原则**
   - 减少不必要的界面元素
   - 突出核心功能和关键信息
   - 合理的信息层级和视觉引导

3. **容错性原则**
   - 提供撤销和重做功能
   - 重要操作前进行确认
   - 友好的错误提示和恢复建议

### 6.2 性能要求

| 界面操作 | 响应时间要求 | 用户感知 |
|---------|-------------|---------|
| 页面切换 | <1秒 | 即时响应 |
| 文件上传 | 视文件大小 | 进度指示 |
| 数据预览 | <2秒 | 快速加载 |
| 排产执行 | <5分钟 | 进度跟踪 |
| 结果展示 | <3秒 | 流畅展示 |

### 6.3 无障碍访问

1. **键盘导航支持**
   - Tab键顺序逻辑合理
   - 支持快捷键操作
   - 焦点状态明显可见

2. **视觉辅助**
   - 足够的颜色对比度
   - 重要信息不仅依赖颜色
   - 支持字体大小调节

## 7. 设计系统规范

### 7.1 色彩规范

```css
/* 主色调 */
--primary-color: #1890ff;      /* 主要按钮、重要信息 */
--secondary-color: #52c41a;    /* 成功状态、确认操作 */
--warning-color: #faad14;      /* 警告信息 */
--error-color: #ff4d4f;        /* 错误信息、危险操作 */

/* 中性色 */
--text-primary: #262626;       /* 主要文本 */
--text-secondary: #8c8c8c;     /* 次要文本 */
--border-color: #d9d9d9;       /* 边框线 */
--background-color: #fafafa;   /* 页面背景 */
--card-background: #ffffff;    /* 卡片背景 */
```

### 7.2 字体规范

```css
/* 字体族 */
font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Microsoft YaHei', sans-serif;

/* 字号层级 */
--font-size-xl: 20px;    /* 页面标题 */
--font-size-lg: 16px;    /* 区块标题 */
--font-size-md: 14px;    /* 正文内容 */
--font-size-sm: 12px;    /* 辅助信息 */
```

### 7.3 间距规范

```css
/* 间距系统 (基于8px网格) */
--spacing-xs: 4px;   /* 极小间距 */
--spacing-sm: 8px;   /* 小间距 */
--spacing-md: 16px;  /* 中等间距 */
--spacing-lg: 24px;  /* 大间距 */
--spacing-xl: 32px;  /* 极大间距 */
```

## 8. 开发交付

### 8.1 设计交付物

1. **设计原型**
   - Figma原型文件
   - 交互动效说明
   - 响应式设计稿

2. **设计规范**
   - UI组件库
   - 图标资源包
   - 设计系统文档

3. **前端资源**
   - CSS样式文件
   - 图片素材
   - 字体文件

### 8.2 前端技术建议

- **框架选择**：React 18 + TypeScript
- **UI组件库**：Ant Design 5.x
- **状态管理**：Redux Toolkit 或 Zustand
- **文件上传**：Ant Design Upload组件
- **图表展示**：Ant Design Charts
- **响应式**：CSS Grid + Flexbox

### 8.3 开发注意事项

1. **组件化开发**
   - 可复用组件设计
   - 统一的属性接口
   - 完善的类型定义

2. **性能优化**
   - 大表格虚拟滚动
   - 图片懒加载
   - 组件按需加载

3. **用户体验**
   - 加载状态提示
   - 错误边界处理
   - 操作反馈及时

---

*本文档版本：v1.0*  
*最后更新：2024-08-26*  
*下一个文档：APS-Business-Requirements.md*